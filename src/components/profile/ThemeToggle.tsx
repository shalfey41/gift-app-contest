import React, { useEffect, useState } from 'react';
import Toggle from '@/components/ui/Toggle';
import { changeColorTheme, getColorTheme } from '@/modules/theme/client';

export default function ThemeToggle() {
  const [isDarkTheme, toggleDarkTheme] = useState(false);
  const [isLoading, setLoader] = useState(true);

  const toggleTheme = (darkTheme: boolean) => {
    toggleDarkTheme(darkTheme);
    changeColorTheme(darkTheme ? 'dark' : 'light');
  };

  useEffect(() => {
    (async () => {
      const colorTheme = await getColorTheme();

      toggleDarkTheme(colorTheme === 'dark');
      setLoader(false);
    })();
  }, []);

  if (isLoading) {
    return null;
  }

  return (
    <Toggle
      isChecked={isDarkTheme}
      onChange={toggleTheme}
      icons={[
        <svg
          key="light"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 16 16"
          className="ml-px w-[16px]"
        >
          <path
            fill="currentColor"
            d="M8 3.184a.74.74 0 0 1-.533-.22.74.74 0 0 1-.219-.532V1.05a.74.74 0 0 1 .219-.533A.729.729 0 0 1 8 .292c.205 0 .38.075.526.226.15.15.226.328.226.533v1.38a.729.729 0 0 1-.226.534.718.718 0 0 1-.526.219Zm3.445 1.449a.762.762 0 0 1-.218-.533c0-.21.07-.385.211-.527l.992-.991a.715.715 0 0 1 .526-.212.692.692 0 0 1 .526.205.733.733 0 0 1 .22.54.681.681 0 0 1-.213.527l-.977.984a.725.725 0 0 1-.534.219.738.738 0 0 1-.533-.212Zm1.429 3.431c0-.205.073-.38.219-.526a.729.729 0 0 1 .533-.226h1.388a.7.7 0 0 1 .52.226c.15.146.225.321.225.526 0 .201-.075.376-.226.527a.71.71 0 0 1-.52.219h-1.387a.74.74 0 0 1-.533-.22.732.732 0 0 1-.219-.526Zm-1.436 3.446a.737.737 0 0 1 .534-.212.692.692 0 0 1 .526.205l.991.984a.703.703 0 0 1 .219.527c0 .21-.07.387-.212.533a.777.777 0 0 1-.533.212.692.692 0 0 1-.526-.205l-.992-.992a.73.73 0 0 1-.218-.519c0-.21.07-.387.211-.533ZM8 12.945c.205 0 .38.073.526.22.15.15.226.325.226.525v1.388c0 .205-.075.38-.226.527A.707.707 0 0 1 8 15.83a.729.729 0 0 1-.533-.226.718.718 0 0 1-.219-.526V13.69c0-.2.073-.375.219-.526A.74.74 0 0 1 8 12.945ZM4.562 11.51a.726.726 0 0 1 .198.533c0 .205-.07.378-.212.52l-.985.99a.727.727 0 0 1-.533.199.738.738 0 0 1-.533-.212.737.737 0 0 1-.212-.533.726.726 0 0 1 .226-.527l.984-.977a.692.692 0 0 1 .526-.205c.215 0 .395.07.54.212ZM3.126 8.064c0 .201-.075.376-.226.527a.726.726 0 0 1-.533.219H.987a.732.732 0 0 1-.527-.22.732.732 0 0 1-.219-.526c0-.205.073-.38.219-.526a.721.721 0 0 1 .526-.226h1.381c.21 0 .388.076.533.226.15.146.226.321.226.526Zm1.422-3.431a.738.738 0 0 1-.533.212.739.739 0 0 1-.527-.219l-.984-.991a.704.704 0 0 1-.205-.52c0-.214.073-.394.219-.54a.692.692 0 0 1 .526-.205c.214 0 .392.07.533.212l.985.991a.69.69 0 0 1 .198.527c0 .214-.07.392-.212.533ZM8 11.7c-.501 0-.973-.093-1.415-.28a3.822 3.822 0 0 1-1.162-.786 3.736 3.736 0 0 1-.786-1.156 3.597 3.597 0 0 1-.28-1.415c0-.505.093-.977.28-1.415.191-.437.453-.822.786-1.155a3.821 3.821 0 0 1 1.162-.786A3.523 3.523 0 0 1 8 4.421c.501 0 .97.096 1.408.287.438.191.823.453 1.155.786.338.333.6.718.787 1.155.191.438.287.91.287 1.415a3.585 3.585 0 0 1-1.073 2.57 3.738 3.738 0 0 1-1.156.787c-.437.187-.907.28-1.408.28Zm0-1.428c.406 0 .775-.098 1.107-.294.333-.201.6-.468.8-.8.2-.333.301-.704.301-1.115 0-.41-.1-.781-.3-1.114-.201-.332-.468-.6-.8-.8-.333-.2-.702-.3-1.108-.3-.41 0-.782.1-1.114.3-.333.2-.6.468-.8.8-.2.333-.3.704-.3 1.114 0 .41.1.782.3 1.115.2.332.467.599.8.8.332.196.704.294 1.114.294Z"
          />
        </svg>,
        <svg
          key="dark"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 15 15"
          className="w-[15px]"
        >
          <path
            fill="currentColor"
            d="M11.232 9.156c.256 0 .509-.016.76-.048.25-.032.487-.073.71-.123.223-.054.42-.116.588-.184.114-.041.212-.073.294-.096a.992.992 0 0 1 .253-.034c.16 0 .298.057.417.17.123.11.184.26.184.452 0 .064-.009.144-.027.24a.998.998 0 0 1-.11.314 7.148 7.148 0 0 1-3.87 3.678 7.11 7.11 0 0 1-2.664.505 7.011 7.011 0 0 1-2.796-.56 7.332 7.332 0 0 1-2.297-1.545 7.275 7.275 0 0 1-1.552-2.297 7.06 7.06 0 0 1-.56-2.803c0-.98.186-1.907.56-2.782a7.314 7.314 0 0 1 1.552-2.317A6.814 6.814 0 0 1 4.97.194C5.085.15 5.183.117 5.265.1 5.35.08 5.42.07 5.47.07c.2 0 .36.066.478.199a.644.644 0 0 1 .185.45.947.947 0 0 1-.041.274c-.023.087-.066.19-.13.308-.128.241-.233.57-.315.984-.077.41-.116.855-.116 1.333 0 1.144.23 2.128.69 2.953a4.746 4.746 0 0 0 1.97 1.914c.852.447 1.866.67 3.041.67ZM2.065 6.791c0 .82.144 1.58.431 2.276a5.62 5.62 0 0 0 1.217 1.826 5.53 5.53 0 0 0 1.825 1.21 5.821 5.821 0 0 0 2.27.437c.61 0 1.2-.089 1.77-.267a5.38 5.38 0 0 0 1.559-.758c.47-.338.866-.739 1.19-1.204-.21.073-.427.126-.65.158a5.926 5.926 0 0 1-.718.04c-1.417 0-2.636-.266-3.657-.799a5.56 5.56 0 0 1-2.338-2.304C4.422 6.404 4.15 5.21 4.15 3.824a5.4 5.4 0 0 1 .24-1.62c-.479.351-.894.768-1.244 1.251a5.79 5.79 0 0 0-.8 1.58 5.602 5.602 0 0 0-.28 1.756Z"
          />
        </svg>,
      ]}
    />
  );
}
